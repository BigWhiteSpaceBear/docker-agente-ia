2026-01-13 12:27:54,114 INFO     18 ragflow_server log path: /ragflow/logs/ragflow_server.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-13 12:27:54,115 INFO     18 
        ____   ___    ______ ______ __
       / __ \ /   |  / ____// ____// /____  _      __
      / /_/ // /| | / / __ / /_   / // __ \| | /| / /
     / _, _// ___ |/ /_/ // __/  / // /_/ /| |/ |/ /
    /_/ |_|/_/  |_|\____//_/    /_/ \____/ |__/|__/

    
2026-01-13 12:27:54,115 INFO     18 RAGFlow version: v0.23.1
2026-01-13 12:27:54,116 INFO     18 project base: /ragflow
2026-01-13 12:27:54,117 INFO     18 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-13 12:27:54,119 WARNING  18 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-13 12:27:54,124 WARNING  18 Load term.freq FAIL!
2026-01-13 12:27:54,133 WARNING  18 Realtime synonym is disabled, since no redis connection.
2026-01-13 12:27:54,137 WARNING  18 Load term.freq FAIL!
2026-01-13 12:27:54,143 WARNING  18 Realtime synonym is disabled, since no redis connection.
2026-01-13 12:27:54,144 INFO     18 MAX_CONTENT_LENGTH: 134217728
2026-01-13 12:27:54,145 INFO     18 MAX_FILE_COUNT_PER_USER: 0
2026-01-13 12:28:12,973 INFO     18 Init message_id sequence done, current max id is 1.
2026-01-13 12:28:12,975 INFO     18 No memory found, no need to init memory size.
2026-01-13 12:28:12,977 INFO     18 init web data success:7.180915117263794
2026-01-13 12:28:12,978 INFO     18 Recursively importing plugins from path `/ragflow/plugin/embedded_plugins`
2026-01-13 12:28:12,980 INFO     18 Loaded llm_tools plugin BadCalculatorPlugin version 1.0.0
2026-01-13 12:28:12,981 INFO     18 RAGFlow HTTP server start...
2026-01-13 12:28:13,245 INFO     18 Running on http://0.0.0.0:9380 (CTRL + C to quit)
2026-01-13 12:28:13,981 INFO     18 Starting update_progress thread (delayed)
2026-01-13 12:28:13,983 INFO     18 update_progress lock_value: cb47c510-9301-4cec-811f-2b661b3d5f06
2026-01-13 12:28:32,477 ERROR    18 The requested URL / was not found
2026-01-13 12:28:32,704 ERROR    18 The requested URL / was not found
2026-01-14 06:07:12,405 INFO     18 ragflow_server log path: /ragflow/logs/ragflow_server.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-14 06:07:12,407 INFO     18 
        ____   ___    ______ ______ __
       / __ \ /   |  / ____// ____// /____  _      __
      / /_/ // /| | / / __ / /_   / // __ \| | /| / /
     / _, _// ___ |/ /_/ // __/  / // /_/ /| |/ |/ /
    /_/ |_|/_/  |_|\____//_/    /_/ \____/ |__/|__/

    
2026-01-14 06:07:12,407 INFO     18 RAGFlow version: v0.23.1
2026-01-14 06:07:12,408 INFO     18 project base: /ragflow
2026-01-14 06:07:12,409 INFO     18 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-14 06:07:12,410 WARNING  18 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-14 06:07:12,415 WARNING  18 Load term.freq FAIL!
2026-01-14 06:07:12,422 WARNING  18 Realtime synonym is disabled, since no redis connection.
2026-01-14 06:07:12,426 WARNING  18 Load term.freq FAIL!
2026-01-14 06:07:12,432 WARNING  18 Realtime synonym is disabled, since no redis connection.
2026-01-14 06:07:12,433 INFO     18 MAX_CONTENT_LENGTH: 134217728
2026-01-14 06:07:12,434 INFO     18 MAX_FILE_COUNT_PER_USER: 0
2026-01-14 06:07:19,148 INFO     18 Init message_id sequence done, current max id is 1.
2026-01-14 06:07:19,152 INFO     18 No memory found, no need to init memory size.
2026-01-14 06:07:19,154 INFO     18 init web data success:6.161041498184204
2026-01-14 06:07:19,156 INFO     18 Recursively importing plugins from path `/ragflow/plugin/embedded_plugins`
2026-01-14 06:07:19,160 INFO     18 Loaded llm_tools plugin BadCalculatorPlugin version 1.0.0
2026-01-14 06:07:19,162 INFO     18 RAGFlow HTTP server start...
2026-01-14 06:07:19,602 INFO     18 Running on http://0.0.0.0:9380 (CTRL + C to quit)
2026-01-14 06:07:20,163 INFO     18 Starting update_progress thread (delayed)
2026-01-14 06:07:20,164 INFO     18 update_progress lock_value: 482457f4-7675-48dd-8959-e6ec5278f297
2026-01-14 06:08:55,997 ERROR    18 The requested URL / was not found
2026-01-14 06:09:09,563 ERROR    18 The requested URL / was not found
2026-01-14 06:09:33,228 ERROR    18 The requested URL / was not found
2026-01-14 06:10:13,312 ERROR    18 The requested URL / was not found
2026-01-14 06:26:02,729 ERROR    18 Model(@None) not authorized
Traceback (most recent call last):
  File "/ragflow/api/apps/conversation_app.py", line 224, in stream
    async for ans in async_chat(dia, msg, True, **req):
  File "/ragflow/api/db/services/dialog_service.py", line 284, in async_chat
    async for ans in async_chat_solo(dialog, messages, stream):
  File "/ragflow/api/db/services/dialog_service.py", line 189, in async_chat_solo
    chat_mdl = LLMBundle(dialog.tenant_id, LLMType.CHAT, dialog.llm_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 87, in __init__
    super().__init__(tenant_id, llm_type, llm_name, lang, **kwargs)
  File "/ragflow/api/db/services/tenant_llm_service.py", line 332, in __init__
    self.mdl = TenantLLMService.model_instance(tenant_id, llm_type, llm_name, lang=lang, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3128, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/tenant_llm_service.py", line 138, in model_instance
    model_config = TenantLLMService.get_model_config(tenant_id, llm_type, llm_name)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3128, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/tenant_llm_service.py", line 126, in get_model_config
    raise LookupError(f"Model({mdlnm}@{fid}) not authorized")
LookupError: Model(@None) not authorized
2026-01-14 06:26:50,473 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:39:35,344 ERROR    18 
Fail to access embedding model(llama3.1).model "llama3.1" not found, try pulling it first (status code: 404)
NoneType: None
2026-01-14 06:41:57,600 INFO     18 [HISTORY][
  {
    "role": "user",
    "content": "Hello! How are you doing!"
  }
]
2026-01-14 06:41:57,725 INFO     18 
LiteLLM completion() model= llama3.1; provider = ollama_chat
2026-01-14 06:41:57,912 INFO     18 
LiteLLM completion() model= llama3.1; provider = ollama_chat
2026-01-14 06:41:57,928 INFO     18 
LiteLLM completion() model= llama3.1; provider = ollama_chat
2026-01-14 06:41:57,944 INFO     18 
LiteLLM completion() model= llama3.1; provider = ollama_chat
2026-01-14 06:41:57,955 INFO     18 
LiteLLM completion() model= llama3.1; provider = ollama_chat
2026-01-14 06:41:57,968 INFO     18 
LiteLLM completion() model= llama3.1; provider = ollama_chat
2026-01-14 06:41:57,990 ERROR    18 LiteLLMBase async completion
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/llms/custom_httpx/llm_http_handler.py", line 156, in _make_common_async_call
    response = await async_httpx_client.post(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 190, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/llms/custom_httpx/http_handler.py", line 450, in post
    raise e
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/llms/custom_httpx/http_handler.py", line 406, in post
    response.raise_for_status()
  File "/ragflow/.venv/lib/python3.12/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://ollama:11434/api/chat'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/main.py", line 607, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/llms/custom_httpx/llm_http_handler.py", line 288, in async_completion
    response = await self._make_common_async_call(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/llms/custom_httpx/llm_http_handler.py", line 181, in _make_common_async_call
    raise self._handle_error(e=e, provider_config=provider_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/llms/custom_httpx/llm_http_handler.py", line 3601, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'llama3.1' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/llm/chat_model.py", line 1270, in async_chat
    response = await litellm.acompletion(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/utils.py", line 1643, in wrapper_async
    raise e
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/utils.py", line 1489, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/main.py", line 626, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2329, in exception_type
    raise e
  File "/ragflow/.venv/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2298, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: Ollama_chatException - {"error":"model 'llama3.1' not found"} LiteLLM Retried: 5 times
2026-01-14 06:41:58,015 ERROR    18 async_chat_streamly giving up: **ERROR**: CONNECTION_ERROR - litellm.APIConnectionError: Ollama_chatException - {"error":"model 'llama3.1' not found"} LiteLLM Retried: 5 times
2026-01-14 06:41:58,019 ERROR    18 
Fail to access model(Ollama/llama3.1).**ERROR**: CONNECTION_ERROR - litellm.APIConnectionError: Ollama_chatException - {"error":"model 'llama3.1' not found"} LiteLLM Retried: 5 times
NoneType: None
2026-01-14 06:43:41,270 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:46:21,586 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:46:28,827 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:46:28,862 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:46:50,602 INFO     18 [HISTORY][
  {
    "role": "user",
    "content": "Hello! How are you doing!"
  }
]
2026-01-14 06:46:50,605 INFO     18 
LiteLLM completion() model= llama3.1; provider = ollama_chat
2026-01-14 06:47:12,716 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:47:55,392 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:47:55,409 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:48:04,645 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:48:37,770 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:48:38,890 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.102s]
2026-01-14 06:49:23,566 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:49:24,584 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.008s]
2026-01-14 06:51:19,767 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:52:19,829 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:52:33,407 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:52:45,531 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:52:47,671 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.005s]
2026-01-14 06:54:08,032 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.004s]
2026-01-14 06:54:28,669 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:54:30,548 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:56:12,236 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:56:12,247 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 06:56:13,258 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.003s]
2026-01-14 06:56:35,510 ERROR    18 The requested URL / was not found
2026-01-14 06:57:01,907 ERROR    18 The requested URL / was not found
2026-01-14 06:57:16,618 ERROR    18 The requested URL / was not found
2026-01-14 07:04:38,431 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.004s]
2026-01-14 07:04:38,439 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 07:04:53,087 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 07:04:53,090 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.004s]
2026-01-14 07:04:59,624 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 07:05:03,443 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 07:05:07,166 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.005s]
2026-01-14 07:06:58,723 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 07:06:58,735 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 07:06:59,750 WARNING  18 Database connection issue (attempt 1/5): (0, '')
2026-01-14 07:06:59,755 INFO     18 HEAD http://es01:9200/ragflow_48200b30f03811f09895fa2acd4ca7c8 [status:404 duration:0.004s]
2026-01-14 07:07:04,221 ERROR    18 The requested URL / was not found
2026-01-14 07:07:50,347 ERROR    18 The requested URL / was not found
2026-01-14 08:03:27,663 ERROR    18 The requested URL / was not found
2026-01-14 08:03:35,421 ERROR    18 The requested URL / was not found
2026-01-14 08:03:43,507 ERROR    18 The requested URL / was not found
2026-01-14 08:03:57,369 ERROR    18 The requested URL / was not found
2026-01-14 08:04:12,899 ERROR    18 The requested URL / was not found
2026-01-14 08:04:26,430 ERROR    18 The requested URL / was not found
2026-01-14 08:04:40,609 ERROR    18 The requested URL / was not found
2026-01-14 08:05:35,179 ERROR    18 The requested URL / was not found
2026-01-14 08:05:59,763 ERROR    18 The requested URL / was not found
2026-01-14 08:06:11,644 ERROR    18 The requested URL / was not found
2026-01-14 08:16:23,666 ERROR    18 The requested URL / was not found
2026-01-14 08:16:50,251 ERROR    18 The requested URL / was not found
2026-01-14 08:17:36,605 ERROR    18 The requested URL / was not found
2026-01-14 08:17:55,022 ERROR    18 The requested URL / was not found
2026-01-14 08:17:58,973 ERROR    18 The requested URL / was not found
2026-01-14 08:18:53,086 ERROR    18 update_progress exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1116, in get_connection
    if connection.can_read() and connection.client_cache is None:
       ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 524, in can_read
    return self._parser.can_read(timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/_parsers/base.py", line 128, in can_read
    return self._buffer and self._buffer.can_read(timeout)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/_parsers/socket.py", line 95, in can_read
    return bool(self.unread_bytes()) or self._read_from_socket(
                                        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/_parsers/socket.py", line 68, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
valkey.exceptions.ConnectionError: Connection closed by server.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
           ^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/api/ragflow_server.py", line 55, in update_progress
    if redis_lock.acquire():
       ^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/utils/redis_conn.py", line 494, in acquire
    REDIS_CONN.delete_if_equal(self.lock_key, self.lock_value)
  File "/ragflow/rag/utils/redis_conn.py", line 468, in delete_if_equal
    return bool(self.lua_delete_if_equal(keys=[key], args=[expected_value], client=self.REDIS))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 6356, in __call__
    return client.evalsha(self.sha, len(keys), *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 5730, in evalsha
    return self._evalsha("EVALSHA", sha, numkeys, *keys_and_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 5714, in _evalsha
    return self.execute_command(command, sha, numkeys, *keys_and_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1120, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2026-01-14 08:18:53,154 ERROR    18 update_progress exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
           ^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/api/ragflow_server.py", line 62, in update_progress
    redis_lock.release()
  File "/ragflow/rag/utils/redis_conn.py", line 505, in release
    REDIS_CONN.delete_if_equal(self.lock_key, self.lock_value)
  File "/ragflow/rag/utils/redis_conn.py", line 468, in delete_if_equal
    return bool(self.lua_delete_if_equal(keys=[key], args=[expected_value], client=self.REDIS))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 6356, in __call__
    return client.evalsha(self.sha, len(keys), *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 5730, in evalsha
    return self._evalsha("EVALSHA", sha, numkeys, *keys_and_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 5714, in _evalsha
    return self.execute_command(command, sha, numkeys, *keys_and_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2026-01-14 08:20:38,179 INFO     24 ragflow_server log path: /ragflow/logs/ragflow_server.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-14 08:20:38,180 INFO     24 
        ____   ___    ______ ______ __
       / __ \ /   |  / ____// ____// /____  _      __
      / /_/ // /| | / / __ / /_   / // __ \| | /| / /
     / _, _// ___ |/ /_/ // __/  / // /_/ /| |/ |/ /
    /_/ |_|/_/  |_|\____//_/    /_/ \____/ |__/|__/

    
2026-01-14 08:20:38,181 INFO     24 RAGFlow version: v0.23.1
2026-01-14 08:20:38,182 INFO     24 project base: /ragflow
2026-01-14 08:20:38,183 INFO     24 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-14 08:20:38,185 WARNING  24 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-14 08:20:38,189 WARNING  24 Load term.freq FAIL!
2026-01-14 08:20:38,195 WARNING  24 Realtime synonym is disabled, since no redis connection.
2026-01-14 08:20:38,198 WARNING  24 Load term.freq FAIL!
2026-01-14 08:20:38,203 WARNING  24 Realtime synonym is disabled, since no redis connection.
2026-01-14 08:20:38,205 INFO     24 MAX_CONTENT_LENGTH: 134217728
2026-01-14 08:20:38,205 INFO     24 MAX_FILE_COUNT_PER_USER: 0
2026-01-14 08:20:46,285 INFO     24 Init message_id sequence done, current max id is 1.
2026-01-14 08:20:46,287 INFO     24 No memory found, no need to init memory size.
2026-01-14 08:20:46,288 INFO     24 init web data success:7.504313230514526
2026-01-14 08:20:46,289 INFO     24 Recursively importing plugins from path `/ragflow/plugin/embedded_plugins`
2026-01-14 08:20:46,291 INFO     24 Loaded llm_tools plugin BadCalculatorPlugin version 1.0.0
2026-01-14 08:20:46,293 INFO     24 RAGFlow HTTP server start...
2026-01-14 08:20:46,553 INFO     24 Running on http://0.0.0.0:9380 (CTRL + C to quit)
2026-01-14 08:20:47,293 INFO     24 Starting update_progress thread (delayed)
2026-01-14 08:20:47,295 INFO     24 update_progress lock_value: e5f12233-d28a-43cf-9c00-b65aee6e3088
2026-01-14 08:25:45,967 INFO     15 ragflow_server log path: /ragflow/logs/ragflow_server.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-14 08:25:45,968 INFO     15 
        ____   ___    ______ ______ __
       / __ \ /   |  / ____// ____// /____  _      __
      / /_/ // /| | / / __ / /_   / // __ \| | /| / /
     / _, _// ___ |/ /_/ // __/  / // /_/ /| |/ |/ /
    /_/ |_|/_/  |_|\____//_/    /_/ \____/ |__/|__/

    
2026-01-14 08:25:45,969 INFO     15 RAGFlow version: v0.23.1
2026-01-14 08:25:45,970 INFO     15 project base: /ragflow
2026-01-14 08:25:45,971 INFO     15 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-14 08:25:45,973 WARNING  15 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-14 08:25:45,978 WARNING  15 Load term.freq FAIL!
2026-01-14 08:25:45,985 WARNING  15 Realtime synonym is disabled, since no redis connection.
2026-01-14 08:25:45,989 WARNING  15 Load term.freq FAIL!
2026-01-14 08:25:45,994 WARNING  15 Realtime synonym is disabled, since no redis connection.
2026-01-14 08:25:45,996 INFO     15 MAX_CONTENT_LENGTH: 134217728
2026-01-14 08:25:45,996 INFO     15 MAX_FILE_COUNT_PER_USER: 0
2026-01-14 08:25:53,450 INFO     15 No need to init message_id sequence, current max id is 1.
2026-01-14 08:25:53,454 INFO     15 No memory found, no need to init memory size.
2026-01-14 08:25:53,455 INFO     15 init web data success:6.919506072998047
2026-01-14 08:25:53,457 INFO     15 Recursively importing plugins from path `/ragflow/plugin/embedded_plugins`
2026-01-14 08:25:53,459 INFO     15 Loaded llm_tools plugin BadCalculatorPlugin version 1.0.0
2026-01-14 08:25:53,461 INFO     15 RAGFlow HTTP server start...
2026-01-14 08:25:53,838 INFO     15 Running on http://0.0.0.0:9380 (CTRL + C to quit)
2026-01-14 08:25:54,461 INFO     15 Starting update_progress thread (delayed)
2026-01-14 08:25:54,462 INFO     15 update_progress lock_value: e17533c0-8ccc-4e13-8eda-ef2a96cf2bc6
2026-01-18 00:54:51,185 INFO     16 ragflow_server log path: /ragflow/logs/ragflow_server.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-18 00:54:51,186 INFO     16 
        ____   ___    ______ ______ __
       / __ \ /   |  / ____// ____// /____  _      __
      / /_/ // /| | / / __ / /_   / // __ \| | /| / /
     / _, _// ___ |/ /_/ // __/  / // /_/ /| |/ |/ /
    /_/ |_|/_/  |_|\____//_/    /_/ \____/ |__/|__/

    
2026-01-18 00:54:51,187 INFO     16 RAGFlow version: v0.23.1
2026-01-18 00:54:51,187 INFO     16 project base: /ragflow
2026-01-18 00:54:51,188 INFO     16 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-18 00:54:51,190 WARNING  16 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-18 00:54:51,194 WARNING  16 Load term.freq FAIL!
2026-01-18 00:54:51,201 WARNING  16 Realtime synonym is disabled, since no redis connection.
2026-01-18 00:54:51,205 WARNING  16 Load term.freq FAIL!
2026-01-18 00:54:51,210 WARNING  16 Realtime synonym is disabled, since no redis connection.
2026-01-18 00:54:51,212 INFO     16 MAX_CONTENT_LENGTH: 134217728
2026-01-18 00:54:51,213 INFO     16 MAX_FILE_COUNT_PER_USER: 0
2026-01-18 00:54:58,416 INFO     16 Init message_id sequence done, current max id is 1.
2026-01-18 00:54:58,418 INFO     16 No memory found, no need to init memory size.
2026-01-18 00:54:58,419 INFO     16 init web data success:6.623716592788696
2026-01-18 00:54:58,420 INFO     16 Recursively importing plugins from path `/ragflow/plugin/embedded_plugins`
2026-01-18 00:54:58,422 INFO     16 Loaded llm_tools plugin BadCalculatorPlugin version 1.0.0
2026-01-18 00:54:58,424 INFO     16 RAGFlow HTTP server start...
2026-01-18 00:54:58,686 INFO     16 Running on http://0.0.0.0:9380 (CTRL + C to quit)
2026-01-18 00:54:59,424 INFO     16 Starting update_progress thread (delayed)
2026-01-18 00:54:59,426 INFO     16 update_progress lock_value: 1b4dcd14-18ac-4d6c-898f-86ebbdedab2a
2026-01-18 01:43:15,435 INFO     18 ragflow_server log path: /ragflow/logs/ragflow_server.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-18 01:43:15,436 INFO     18 
        ____   ___    ______ ______ __
       / __ \ /   |  / ____// ____// /____  _      __
      / /_/ // /| | / / __ / /_   / // __ \| | /| / /
     / _, _// ___ |/ /_/ // __/  / // /_/ /| |/ |/ /
    /_/ |_|/_/  |_|\____//_/    /_/ \____/ |__/|__/

    
2026-01-18 01:43:15,437 INFO     18 RAGFlow version: v0.23.1
2026-01-18 01:43:15,439 INFO     18 project base: /ragflow
2026-01-18 01:43:15,441 INFO     18 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-18 01:43:15,444 WARNING  18 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-18 01:43:15,449 WARNING  18 Load term.freq FAIL!
2026-01-18 01:43:15,457 WARNING  18 Realtime synonym is disabled, since no redis connection.
2026-01-18 01:43:15,461 WARNING  18 Load term.freq FAIL!
2026-01-18 01:43:15,468 WARNING  18 Realtime synonym is disabled, since no redis connection.
2026-01-18 01:43:15,470 INFO     18 MAX_CONTENT_LENGTH: 134217728
2026-01-18 01:43:15,471 INFO     18 MAX_FILE_COUNT_PER_USER: 0
2026-01-18 01:43:34,983 INFO     18 Init message_id sequence done, current max id is 1.
2026-01-18 01:43:34,985 INFO     18 No memory found, no need to init memory size.
2026-01-18 01:43:34,986 INFO     18 init web data success:6.869725227355957
2026-01-18 01:43:34,988 INFO     18 Recursively importing plugins from path `/ragflow/plugin/embedded_plugins`
2026-01-18 01:43:34,990 INFO     18 Loaded llm_tools plugin BadCalculatorPlugin version 1.0.0
2026-01-18 01:43:34,992 INFO     18 RAGFlow HTTP server start...
2026-01-18 01:43:35,296 INFO     18 Running on http://0.0.0.0:9380 (CTRL + C to quit)
2026-01-18 01:43:35,992 INFO     18 Starting update_progress thread (delayed)
2026-01-18 01:43:35,993 INFO     18 update_progress lock_value: 0d466482-1f08-48ec-a163-aec2846dc1d0
2026-01-18 01:45:08,729 INFO     17 ragflow_server log path: /ragflow/logs/ragflow_server.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-18 01:45:08,730 INFO     17 
        ____   ___    ______ ______ __
       / __ \ /   |  / ____// ____// /____  _      __
      / /_/ // /| | / / __ / /_   / // __ \| | /| / /
     / _, _// ___ |/ /_/ // __/  / // /_/ /| |/ |/ /
    /_/ |_|/_/  |_|\____//_/    /_/ \____/ |__/|__/

    
2026-01-18 01:45:08,731 INFO     17 RAGFlow version: v0.23.1
2026-01-18 01:45:08,731 INFO     17 project base: /ragflow
2026-01-18 01:45:08,732 INFO     17 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-18 01:45:08,734 WARNING  17 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-18 01:45:08,738 WARNING  17 Load term.freq FAIL!
2026-01-18 01:45:08,745 WARNING  17 Realtime synonym is disabled, since no redis connection.
2026-01-18 01:45:08,749 WARNING  17 Load term.freq FAIL!
2026-01-18 01:45:08,754 WARNING  17 Realtime synonym is disabled, since no redis connection.
2026-01-18 01:45:08,756 INFO     17 MAX_CONTENT_LENGTH: 134217728
2026-01-18 01:45:08,757 INFO     17 MAX_FILE_COUNT_PER_USER: 0
2026-01-18 01:45:16,799 INFO     17 No need to init message_id sequence, current max id is 1.
2026-01-18 01:45:16,804 INFO     17 No memory found, no need to init memory size.
2026-01-18 01:45:16,806 INFO     17 init web data success:7.517308950424194
2026-01-18 01:45:16,808 INFO     17 Recursively importing plugins from path `/ragflow/plugin/embedded_plugins`
2026-01-18 01:45:16,811 INFO     17 Loaded llm_tools plugin BadCalculatorPlugin version 1.0.0
2026-01-18 01:45:16,814 INFO     17 RAGFlow HTTP server start...
2026-01-18 01:45:17,180 INFO     17 Running on http://0.0.0.0:9380 (CTRL + C to quit)
2026-01-18 01:45:17,814 INFO     17 Starting update_progress thread (delayed)
2026-01-18 01:45:17,815 INFO     17 update_progress lock_value: fcdaef81-3bff-44c4-8453-e2a741ba111b
