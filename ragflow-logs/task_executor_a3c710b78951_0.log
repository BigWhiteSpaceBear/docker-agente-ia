2026-01-13 12:27:49,479 INFO     31 task_executor_a3c710b78951_0 log path: /ragflow/logs/task_executor_a3c710b78951_0.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-13 12:27:49,480 INFO     31 Staggering startup by 0.23s to prevent connection storm
2026-01-13 12:27:49,715 INFO     31 
    ____                      __  _
   /  _/___  ____ ____  _____/ /_(_)___  ____     ________  ______   _____  _____
   / // __ \/ __ `/ _ \/ ___/ __/ / __ \/ __ \   / ___/ _ \/ ___/ | / / _ \/ ___/
 _/ // / / / /_/ /  __(__  ) /_/ / /_/ / / / /  (__  )  __/ /   | |/ /  __/ /
/___/_/ /_/\__, /\___/____/\__/_/\____/_/ /_/  /____/\___/_/    |___/\___/_/
          /____/
    
2026-01-13 12:27:49,716 INFO     31 RAGFlow version: v0.23.1
2026-01-13 12:27:49,717 INFO     31 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-13 12:27:49,719 WARNING  31 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-13 12:27:49,728 INFO     31 GET http://es01:9200/ [status:200 duration:0.006s]
2026-01-13 12:27:49,732 INFO     31 HEAD http://es01:9200/ [status:200 duration:0.004s]
2026-01-13 12:27:49,734 INFO     31 Use Elasticsearch http://es01:9200 as the doc engine.
2026-01-13 12:27:49,735 INFO     31 Elasticsearch http://es01:9200 is healthy.
2026-01-13 12:27:49,736 INFO     31 Use Elasticsearch http://es01:9200 as the doc engine.
2026-01-13 12:27:49,737 INFO     31 Elasticsearch http://es01:9200 is healthy.
2026-01-13 12:27:49,741 WARNING  31 Load term.freq FAIL!
2026-01-13 12:27:49,747 WARNING  31 Realtime synonym is disabled, since no redis connection.
2026-01-13 12:27:49,755 WARNING  31 Load term.freq FAIL!
2026-01-13 12:27:49,761 WARNING  31 Realtime synonym is disabled, since no redis connection.
2026-01-13 12:27:49,763 INFO     31 can't import package 'torch'
2026-01-13 12:27:49,763 INFO     31 default embedding config: {'model': '', 'factory': '', 'api_key': 'xxx', 'base_url': 'http://tei:80'}
2026-01-13 12:27:49,764 INFO     31 MAX_CONTENT_LENGTH: 134217728
2026-01-13 12:27:49,765 INFO     31 MAX_FILE_COUNT_PER_USER: 0
2026-01-13 12:27:49,769 WARNING  31 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2026-01-13 12:27:49,771 WARNING  31 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2026-01-13 12:27:49,773 WARNING  31 RedisDB.queue_info rag_flow_svr_queue got exception: no such key
2026-01-13 12:27:49,775 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:27:49.768+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:27:49,778 WARNING  31 RedisDB.get_unacked_iterator queue rag_flow_svr_queue_1 doesn't exist
2026-01-13 12:27:49,779 WARNING  31 RedisDB.get_unacked_iterator queue rag_flow_svr_queue doesn't exist
2026-01-13 12:28:18,707 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:28:18.704+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:28:47,619 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:28:47.618+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:29:16,546 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:29:16.545+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:29:45,442 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:29:45.441+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:30:14,359 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:30:14.359+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:30:43,308 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:30:43.307+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:31:12,232 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:31:12.231+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:31:41,154 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:31:41.153+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:32:10,058 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:32:10.057+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:32:38,963 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:32:38.962+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:33:07,883 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:33:07.882+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:33:36,791 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:33:36.791+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:34:05,701 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:34:05.700+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:34:34,605 INFO     31 task_executor_a3c710b78951_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 31, "name": "task_executor_a3c710b78951_0", "now": "2026-01-13T12:34:34.605+08:00", "boot_at": "2026-01-13T12:27:49.475+08:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2026-01-13 12:34:37,249 ERROR    31 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 176, in collect
    redis_msg = next(UNACKED_ITERATOR)
                ^^^^^^^^^^^^^^^^^^^^^^
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1116, in get_connection
    if connection.can_read() and connection.client_cache is None:
       ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 524, in can_read
    return self._parser.can_read(timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/_parsers/base.py", line 128, in can_read
    return self._buffer and self._buffer.can_read(timeout)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/_parsers/socket.py", line 95, in can_read
    return bool(self.unread_bytes()) or self._read_from_socket(
                                        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/_parsers/socket.py", line 68, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
valkey.exceptions.ConnectionError: Connection closed by server.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
           ^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 358, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1120, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2026-01-13 12:34:37,255 ERROR    31 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 176, in collect
    redis_msg = next(UNACKED_ITERATOR)
                ^^^^^^^^^^^^^^^^^^^^^^
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
           ^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 358, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2026-01-13 12:34:37,257 ERROR    31 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 176, in collect
    redis_msg = next(UNACKED_ITERATOR)
                ^^^^^^^^^^^^^^^^^^^^^^
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
           ^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 358, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2026-01-13 12:34:37,259 ERROR    31 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 176, in collect
    redis_msg = next(UNACKED_ITERATOR)
                ^^^^^^^^^^^^^^^^^^^^^^
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
           ^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 358, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2026-01-13 12:34:37,262 ERROR    31 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 176, in collect
    redis_msg = next(UNACKED_ITERATOR)
                ^^^^^^^^^^^^^^^^^^^^^^
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
           ^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 358, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2026-01-13 12:34:37,265 ERROR    31 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 176, in collect
    redis_msg = next(UNACKED_ITERATOR)
                ^^^^^^^^^^^^^^^^^^^^^^
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
           ^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 358, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
